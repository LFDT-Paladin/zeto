package util

import (
	"encoding/hex"
	"testing"

	zktypes "github.com/iden3/go-rapidsnark/types"
	"github.com/stretchr/testify/assert"
)

func TestEncodeProofToBytes(t *testing.T) {
	// Create a mock proof structure
	proof := &zktypes.ZKProof{
		Proof: &zktypes.ProofData{
			A: []string{
				"19419894181753946885905644368046847329207765137646602665981849849988177743059",
				"8860978609790168474767280492049619889501902847625004440136511955001364468415",
			},
			B: [][]string{
				{
					"9615575088076752629397084217945947779665289892224135440531875614084365249217",
					"8718550324938987957095508092102403533235190813736638001821208030813968638254",
				},
				{
					"4507949473085915953198782111072352449926955230934371249989726205978821319356",
					"2606785578797556551529006970822259402011711298405435930848444219387480770792",
				},
			},
			C: []string{
				"10447661281555614767826338373521147852467370112423332977409468234577352614898",
				"6920596160795468120428710510209510475789771793984566256082007483448385924774",
			},
		},
	}

	// Test encoding
	encodedBytes, err := EncodeProofToBytes(proof)

	// Assertions
	assert.NoError(t, err)
	assert.NotNil(t, encodedBytes)
	expected := "2aef45457254c6b207811c860ff4474360a1353613c7100f1e718fabcb884cd3139722db9afdb3d7ce13a5e5eb9cffcb3dbd0c89d56bfdc13e576062b97052bf1346864ce74636589726924b7378aff0bcb1c92a1d204f7bbfb500b58143a12e154238fe9745e67da3ccad55587c8aae45cf9b6204eb24224a35ee4599576ac105c3636b0624515971c23b703549f177ffe91da43acfaf0b938da56340a208e809f768b3202645dc8d02935e8ac99e1e9a1b9a21b7059c0b071ea5baf35cdabc17192aaedbc35296f6650dcee762ab5a0d19876b06c07f5893d881fb3a0c63f20f4ceb2a75e0e80ecd017db6f9d640e1697b80d0a35ec73483529e9e4ec4eea6"
	assert.Equal(t, expected, hex.EncodeToString(encodedBytes))
}
